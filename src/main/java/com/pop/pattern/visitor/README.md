#### 访问者模式（Visitor Pattern）

是一种将数据结构与数据操作分离的设计模式。是指封装一些作用于某种数据结构中的各元素的操作。

特征：可以在不改变数据结构的前提下定义作用于这些元素的新的操作

**属于行为型模式**



#### 访问者模式的适用场景

* 数据结构稳定，作用于数据结构操作经常变化的场景
* 需要数据结构与数据操作分离的常见
* 需要对不同的数据类型（元素）进行操作，而不使用分支判断具体类型的场景





#### 源码中的体现

FileVisitor,spring 中的 BeanDefintionVisitor



#### 访问者模式的优点

* 解耦了解数据结构与数据操作，是的操作集合可以独立变化
* 扩展性好：可以通过扩展访问者角色，实现对数据集的不同操作
* 元素具体类型并非单一，访问者均可以操作
* 各个角色职责分离，符合单一职责原则。



#### 访问者模式的缺点

* 无法增加元素类型：若系统数据结构对象易于变化，经常有新的数据对象增加进来，则访问者类必须增加对象元素的类型操作，违背了开闭原则
* 具体元素变更困难：具体元素增加属性，删除属性等操作会导致对应访问者需要进行相应的修改，尤其当有大量访问者类时，修改范围太大
* 违背依赖倒置原则，为了达到“区别对象”，访问者依赖的是具体元素类型，而不是抽象。



把数据操作和数据结构进行分离是访问者的精髓



你可以理解成访问者模式，是对很多数据的清洗，然后根据不同的访问者得到不同结果的模式

例如，对于KPI考核来说，CEO在意的是每个部门的kpi情况，但是具体的部门的管理者在意的可能是个人的营业情况，也可能是每天的代码量作为评审标准。

总的来说，访问者并不会对数据产生什么改变，只是可以针对访问者角色的不同，又或者是访问者的不同，可以得到不同的结果，从而达到数据结构和数据操作的分离。